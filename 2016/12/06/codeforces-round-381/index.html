

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    
    <meta name="author" content="pitmates">
    
    <meta name="description" content="codeforces round 381">
    
    

    
    
    

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>codeforces round 381 | pitmates&#39; blog · remember something</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">

    <!-- Javascript -->
    <script src="/js/jquery-2.1.0.min.js"></script>
    <script src="/js/jquery.backstretch.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="/js/headroom.min.js"></script>
    <script src="/js/jquery.headroom.min.js"></script> 
    <script src="/js/common.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="banner">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://zlper.net" title="pitmates' blog">pitmates&#39; blog</a>
            </div>

            <div role="navigation" class="collapse navbar-collapse bs-navbar-collapse">
                <p class="navbar-text pull-right">remember something</p>

                <ul class="nav navbar-nav">
                    
                    <li id="nav-index"><a href="/">首页</a></li>
                    
                    <li id="nav-archives"><a href="/archives">归档</a></li>
                    
                    <li id="nav-tags"><a href="/tags">标签</a></li>
                    
                    <li id="nav-categories"><a href="/categories">分类</a></li>
                    
                    <li id="nav-vita"><a href="/vita">关于</a></li>
                    
                    <li id="nav-links"><a href="/links">链接</a></li>
                    
                    
                    <li><a href="https://github.com/pitmates" target="_blank">GitHub</a></li>
                </ul>
            </div>
        </div>
    </nav>
    
    <script>
    var backRoot = "/images/background/";
    var backArray = [ "1.jpeg", "2.jpg", "3.png", "4.jpg", "5.jpg", "6.jpg", "7.jpeg", "8.jpg", "9.png", "10.jpg", "11.jpg", "12.jpg", "13.jpg", "14.jpg", "15.jpg",  ];
        
    $(function() {
        // page-id...
        var pageId = "2016/12/06/codeforces-round-381/";
        pageId = pageId.substr(0, pageId.indexOf("/"));
        if(pageId === "") pageId = "index";
        
        $("#nav-" + pageId).addClass("active");
    });
    </script>

    <article class="post container">
    <div class="well post-body first-post last-post">
        <h1>codeforces round 381</h1>
        
        <div class="time-info">
发表于:<time datetime="2016-12-06T11:44:13.000Z" itemprop="datePublished">2016-12-06</time>，更新于:<time datetime="2016-12-06T12:57:09.873Z" itemprop="dateModified">2016-12-06</time>，By <a href="http://zlper.net" title="pitmates">pitmates</a>
        </div>
        
        <div class="post-body-inner">
            <div id="toc" class="toc-article well">
                <font size=3><strong class="toc-title">大纲</strong></font size>
                <font size=3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#740A、Alyona-and-copybooks"><span class="toc-number">1.</span> <span class="toc-text">740A、Alyona and copybooks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#思路："><span class="toc-number">1.1.</span> <span class="toc-text">思路：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#code"><span class="toc-number">1.2.</span> <span class="toc-text">code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#740B、Alyona-and-flowers"><span class="toc-number">2.</span> <span class="toc-text">740B、Alyona and flowers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#解法："><span class="toc-number">2.1.</span> <span class="toc-text">解法：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#code-1"><span class="toc-number">2.2.</span> <span class="toc-text">code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#739A、Alyona-and-mex"><span class="toc-number">3.</span> <span class="toc-text">739A、Alyona and mex</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#解法：-1"><span class="toc-number">3.1.</span> <span class="toc-text">解法：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#code-2"><span class="toc-number">3.2.</span> <span class="toc-text">code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#739B、Alyona-and-a-tree"><span class="toc-number">4.</span> <span class="toc-text">739B、Alyona and a tree</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#解法：-2"><span class="toc-number">4.1.</span> <span class="toc-text">解法：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#code-3"><span class="toc-number">4.2.</span> <span class="toc-text">code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#739C、Alyona-and-towers"><span class="toc-number">5.</span> <span class="toc-text">739C、Alyona and towers</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#解法：-3"><span class="toc-number">5.1.</span> <span class="toc-text">解法：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#code-4"><span class="toc-number">5.2.</span> <span class="toc-text">code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#739D、739E待解决"><span class="toc-number">6.</span> <span class="toc-text">739D、739E待解决</span></a></li></ol></font size>
            </div>
            
            <font size=4><p>　　<a href="http://codeforces.com/contest/740" target="_blank" rel="external">codeforces round 381</a> </p>
<a id="more"></a>
<h2 id="740A、Alyona-and-copybooks"><a href="#740A、Alyona-and-copybooks" class="headerlink" title="740A、Alyona and copybooks"></a>740A、Alyona and copybooks</h2><h3 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h3><p>　　枚举缺少1,2,3本书的时候所要买的书的本书，比如缺少3本书，可以买1本、5本、9本，从中找到最小的。</p>
<h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><figure class="highlight hsp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> &lt;bits/stdc++.h&gt;</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, j, k) for(int i = (int) j; i &lt; (int) k; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) ((int) (x).size())</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair&lt;int, int &gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf <span class="number">0</span>x3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF <span class="number">0</span>x3f3f3f3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zero(x) memset((x), (<span class="number">0</span>), sizeof (x))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zerox(x, y) memset((x), (y), sizeof (x))</span></div><div class="line"></div><div class="line">using namespace std<span class="comment">;</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main()</div><div class="line">&#123;</div><div class="line">    ios_base::sync_with_stdio(false)<span class="comment">; cin.tie(0);</span></div><div class="line"></div><div class="line">    ll n, a, b, c<span class="comment">;</span></div><div class="line">    cin &gt;&gt; n &gt;&gt; a &gt;&gt; b &gt;&gt; c<span class="comment">;</span></div><div class="line">    <span class="keyword">if</span>(n % <span class="number">4</span> == <span class="number">0</span>) puts(<span class="string">"0"</span>)<span class="comment">;</span></div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">int</span> md = n % <span class="number">4</span><span class="comment">;</span></div><div class="line">        <span class="keyword">if</span>(md == <span class="number">3</span>) cout &lt;&lt; min(min(a, b+c), c+c+c) &lt;&lt; endl<span class="comment">;</span></div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(md == <span class="number">2</span>) cout &lt;&lt; min(min(a+a, b), c+c) &lt;&lt; endl<span class="comment">;</span></div><div class="line">        <span class="keyword">else</span> cout &lt;&lt; min(min(a+a+a, c), a+b) &lt;&lt; endl<span class="comment">;</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span><span class="comment">;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="740B、Alyona-and-flowers"><a href="#740B、Alyona-and-flowers" class="headerlink" title="740B、Alyona and flowers"></a>740B、Alyona and flowers</h2><h3 id="解法："><a href="#解法：" class="headerlink" title="解法："></a>解法：</h3><p>　　先求前缀和pre[i]，当选取区间和大于0时就选取，值在<code>-100~100</code>之间，开个200数组，k表示<code>k-100</code>出现的频率，<code>0~200</code> 扫一遍计算即可。</p>
<h3 id="code-1"><a href="#code-1" class="headerlink" title="code"></a>code</h3><figure class="highlight hsp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> &lt;bits/stdc++.h&gt;</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, j, k) for(int i = (int) j; i &lt; (int) k; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) ((int) (x).size())</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair&lt;int, int &gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf <span class="number">0</span>x3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF <span class="number">0</span>x3f3f3f3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zero(x) memset((x), (<span class="number">0</span>), sizeof (x))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zerox(x, y) memset((x), (y), sizeof (x))</span></div><div class="line"></div><div class="line">using namespace std<span class="comment">;</span></div><div class="line"></div><div class="line">const <span class="keyword">int</span> N = <span class="number">110</span><span class="comment">;</span></div><div class="line"><span class="keyword">int</span> n, m<span class="comment">;</span></div><div class="line"><span class="keyword">int</span> a[N], pre[N]<span class="comment">;</span></div><div class="line"><span class="keyword">int</span> p[N&lt;&lt;<span class="number">1</span>]<span class="comment">;</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main()</div><div class="line">&#123;</div><div class="line">    ios_base::sync_with_stdio(false)<span class="comment">; cin.tie(0);</span></div><div class="line"></div><div class="line">    cin &gt;&gt; n &gt;&gt; m<span class="comment">; pre[0] = 0;</span></div><div class="line">    rep(i, <span class="number">1</span>, n+<span class="number">1</span>) cin &gt;&gt; a[i], pre[i] = pre[i<span class="number">-1</span>] + a[i]<span class="comment">;</span></div><div class="line">    <span class="keyword">int</span> l, r<span class="comment">;</span></div><div class="line">    zero(p)<span class="comment">;</span></div><div class="line">    rep(i, <span class="number">0</span>, m) &#123;</div><div class="line">        cin &gt;&gt; l &gt;&gt; r<span class="comment">;</span></div><div class="line">        <span class="keyword">if</span>(pre[r] - pre[l<span class="number">-1</span>] &lt;= <span class="number">0</span>) <span class="keyword">continue</span><span class="comment">;</span></div><div class="line">        rep(j, l, r+<span class="number">1</span>) p[a[j]+<span class="number">100</span>]++<span class="comment">;</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> ans = <span class="number">0</span><span class="comment">;</span></div><div class="line">    rep(i, <span class="number">0</span>, N&lt;&lt;<span class="number">1</span>) <span class="keyword">if</span>(p[i]) ans += (i<span class="number">-100</span>)*p[i]<span class="comment">;</span></div><div class="line">    cout &lt;&lt; ans <span class="comment">;</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span><span class="comment">;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="739A、Alyona-and-mex"><a href="#739A、Alyona-and-mex" class="headerlink" title="739A、Alyona and mex"></a>739A、Alyona and mex</h2><h3 id="解法：-1"><a href="#解法：-1" class="headerlink" title="解法："></a>解法：</h3><p>　　先找出最小的区间长度<code>len</code>，答案肯定是该长度<code>len+1</code>。数字的填法可以从1位开始依次填<code>0 ~ len-1</code>。<br>　　区间长度大于len的肯定包含<code>0 ~ len-1</code>。<br>　　区间长度等于len的，假设从k开始（k&lt;len），则填充的是<code>k, k+1, ..., len-1, 0, 1, ..., k-1</code>，刚好len个。</p>
<h3 id="code-2"><a href="#code-2" class="headerlink" title="code"></a>code</h3><figure class="highlight gauss"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> &lt;bits/stdc++.h&gt;</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, j, k) for(int i = (int) j; i &lt; (int) k; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) ((int) (x).size())</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair&lt;int, int &gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 0x3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x3f3f3f3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zero(x) memset((x), (0), sizeof (x))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zerox(x, y) memset((x), (y), sizeof (x))</span></div><div class="line"></div><div class="line">using namespace std;</div><div class="line">const int N = <span class="number">100100</span>;</div><div class="line"></div><div class="line">int n, m;</div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    ios_base::sync_with_stdio(false); cin.tie(<span class="number">0</span>);</div><div class="line"></div><div class="line">    cin &gt;&gt; n &gt;&gt; m;</div><div class="line">    int l, r, <span class="built_in">minv</span> = inf;</div><div class="line">    rep(i, <span class="number">0</span>, m) &#123;</div><div class="line">        cin &gt;&gt; l &gt;&gt; r;</div><div class="line">        <span class="built_in">minv</span> = min(<span class="built_in">minv</span>, r-l+<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    cout &lt;&lt; <span class="built_in">minv</span> &lt;&lt; endl;</div><div class="line">    rep(i, <span class="number">1</span>, n+<span class="number">1</span>) cout &lt;&lt; i % <span class="built_in">minv</span> &lt;&lt; <span class="string">" "</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="739B、Alyona-and-a-tree"><a href="#739B、Alyona-and-a-tree" class="headerlink" title="739B、Alyona and a tree"></a>739B、Alyona and a tree</h2><h3 id="解法：-2"><a href="#解法：-2" class="headerlink" title="解法："></a>解法：</h3><p>　　定义<code>ans[i]</code>表示i号节点的答案。对于每个点，找其子树的一条链（<code>dfs</code>），那么它的子节点的深度值<code>deep[k]</code>一定不小于父节点的深度值。对于链中的点，计算父节点中能包含它的最远的点（<code>二分</code>），dfs回溯的时候父节点ans值加上子节点的ans值就行了。<br>　　最后ans值要-1，因为计算时包含了当前节点。</p>
<h3 id="code-3"><a href="#code-3" class="headerlink" title="code"></a>code</h3><figure class="highlight mipsasm"><table><tr><td class="code"><pre><div class="line"><span class="comment">#include &lt;bits/stdc++.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">#define rep(i, j, k) for(int i = (int) j; i &lt; (int) k; ++i)</span></div><div class="line"><span class="comment">#define sz(x) ((int) (x).size())</span></div><div class="line"><span class="comment">#define ll long long</span></div><div class="line"><span class="comment">#define mp make_pair</span></div><div class="line"><span class="comment">#define pii pair&lt;int, int &gt;</span></div><div class="line"><span class="comment">#define fi first</span></div><div class="line"><span class="comment">#define se second</span></div><div class="line"><span class="comment">#define pb push_back</span></div><div class="line"><span class="comment">#define inf 0x3f3f3f3f</span></div><div class="line"><span class="comment">#define INF 0x3f3f3f3f3f3f3f</span></div><div class="line"><span class="comment">#define zero(x) memset((x), (0), sizeof (x))</span></div><div class="line"><span class="comment">#define zerox(x, y) memset((x), (y), sizeof (x))</span></div><div class="line"></div><div class="line"><span class="comment">#define pli pair&lt;long long, int &gt;</span></div><div class="line">using namespace std<span class="comment">;</span></div><div class="line">const int N = <span class="number">200100</span><span class="comment">;</span></div><div class="line"></div><div class="line">vector&lt;pii &gt; E[N]<span class="comment">;</span></div><div class="line">vector&lt;pli &gt; path<span class="comment">;</span></div><div class="line"><span class="keyword">ll </span>a[N], deep[N]<span class="comment">;</span></div><div class="line">int ans[N], n<span class="comment">;</span></div><div class="line"></div><div class="line">void dfs(int u) &#123;</div><div class="line">    ans[u]++<span class="comment">;</span></div><div class="line">    int p = lower_bound(path.<span class="keyword">begin(), </span>path<span class="meta">.end</span>(), mp(deep[u]-a[u], -<span class="number">1</span>)) - path.<span class="keyword">begin() </span>- <span class="number">1</span><span class="comment">;</span></div><div class="line">    if(p &gt;= <span class="number">0</span>) ans[path[p].se]--<span class="comment">;</span></div><div class="line">    path.pb(&#123;deep[u], u&#125;)<span class="comment">;</span></div><div class="line">    for(auto&amp; v:E[u])&#123;</div><div class="line">        deep[v.fi] = deep[u] + v.se<span class="comment">;</span></div><div class="line">        dfs(v.fi)<span class="comment">;</span></div><div class="line">        ans[u] += ans[v.fi]<span class="comment">;</span></div><div class="line">    &#125;</div><div class="line">    path.pop_back()<span class="comment">;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line"><span class="symbol">    ios_base:</span>:<span class="keyword">sync_with_stdio(false); </span>cin.tie(<span class="number">0</span>)<span class="comment">;</span></div><div class="line">    </div><div class="line">    cin &gt;&gt; n<span class="comment">;</span></div><div class="line">    rep(i, <span class="number">1</span>, <span class="number">1</span>+n) cin &gt;&gt; a[i], ans[i] = <span class="number">0</span>, deep[i] = <span class="number">0</span><span class="comment">;</span></div><div class="line">    rep(i, <span class="number">2</span>, <span class="number">1</span>+n) &#123;</div><div class="line">        int p, w<span class="comment">;</span></div><div class="line">        cin &gt;&gt; p &gt;&gt; w<span class="comment">;</span></div><div class="line">        E[p].pb(&#123;i, w&#125;)<span class="comment">;</span></div><div class="line">    &#125;</div><div class="line">    dfs(<span class="number">1</span>)<span class="comment">;</span></div><div class="line"></div><div class="line">    rep(i, <span class="number">1</span>, n+<span class="number">1</span>) cout &lt;&lt; ans[i]-<span class="number">1</span> &lt;&lt; <span class="string">" "</span><span class="comment">;</span></div><div class="line">    return <span class="number">0</span><span class="comment">;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="739C、Alyona-and-towers"><a href="#739C、Alyona-and-towers" class="headerlink" title="739C、Alyona and towers"></a>739C、Alyona and towers</h2><h3 id="解法：-3"><a href="#解法：-3" class="headerlink" title="解法："></a>解法：</h3><p>　　首先，对于每个点<code>a[i]</code>，求其相邻的点的差值<code>arr[i] = a[i+1] - a[i]</code>。这样做的好处在于，当计算区间<code>[l, r]</code>时，相应变化的只有<code>arr[l-1]</code>和<code>arr[r]</code>，其余值不变（因为差值）。这样将线段树的区间更新变为单点更新操作。<br>　　线段树维护3个值，该节点覆盖区域的最长前缀合法序列pre，最长后缀合法序列suf和最长合法序列ans。最后根节点的ans值就是答案了。</p>
<h3 id="code-4"><a href="#code-4" class="headerlink" title="code"></a>code</h3><figure class="highlight hsp"><table><tr><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> &lt;bits/stdc++.h&gt;</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, j, k) for(int i = (int) j; i &lt; (int) k; ++i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> sz(x) ((int) (x).size())</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pii pair&lt;int, int &gt;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> inf <span class="number">0</span>x3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF <span class="number">0</span>x3f3f3f3f3f3f3f</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zero(x) memset((x), (<span class="number">0</span>), sizeof (x))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> zerox(x, y) memset((x), (y), sizeof (x))</span></div><div class="line"></div><div class="line">using namespace std<span class="comment">;</span></div><div class="line">const <span class="keyword">int</span> N = <span class="number">300003</span><span class="comment">;</span></div><div class="line"></div><div class="line">ll arr[N]<span class="comment">;</span></div><div class="line"><span class="keyword">int</span> n, q<span class="comment">;</span></div><div class="line"></div><div class="line">struct Segment_Tree &#123;</div><div class="line">    struct Tree&#123;</div><div class="line">        <span class="keyword">int</span> pre, suf, ans<span class="comment">;</span></div><div class="line">    &#125;tree[N&lt;&lt;<span class="number">2</span>]<span class="comment">;</span></div><div class="line"></div><div class="line">    void pushUP(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt) &#123;</div><div class="line">        tree[rt].pre = tree[rt&lt;&lt;<span class="number">1</span>].pre<span class="comment">; tree[rt].suf = tree[rt&lt;&lt;1|1].suf;</span></div><div class="line">        tree[rt].ans = max(tree[rt&lt;&lt;<span class="number">1</span>].ans, tree[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].ans)<span class="comment">;</span></div><div class="line">        <span class="keyword">int</span> m = (l + r) &gt;&gt; <span class="number">1</span><span class="comment">;</span></div><div class="line">        <span class="keyword">if</span>(!arr[m] || !arr[m+<span class="number">1</span>] || (arr[m] &lt; <span class="number">0</span> &amp;&amp; arr[m+<span class="number">1</span>] &gt; <span class="number">0</span>)) <span class="keyword">return</span> <span class="comment">;</span></div><div class="line">        <span class="keyword">if</span>(tree[rt&lt;&lt;<span class="number">1</span>].pre == m-l+<span class="number">1</span>) tree[rt].pre = tree[rt&lt;&lt;<span class="number">1</span>].pre + tree[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].pre<span class="comment">;</span></div><div class="line">        <span class="keyword">if</span>(tree[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].suf == r-m) tree[rt].suf = tree[rt&lt;&lt;<span class="number">1</span>].suf + tree[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].suf<span class="comment">;</span></div><div class="line">        tree[rt].ans = max(tree[rt].ans, tree[rt&lt;&lt;<span class="number">1</span>].suf + tree[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>].pre)<span class="comment">;</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    void build(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt) &#123;</div><div class="line">        <span class="keyword">if</span>(l == r) &#123;</div><div class="line">            tree[rt].pre = tree[rt].suf = tree[rt].ans = <span class="number">1</span><span class="comment">;</span></div><div class="line">            <span class="keyword">return</span> <span class="comment">;</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> m = (l + r) &gt;&gt; <span class="number">1</span><span class="comment">;</span></div><div class="line">        build(l, m, rt&lt;&lt;<span class="number">1</span>)<span class="comment">;</span></div><div class="line">        build(m+<span class="number">1</span>, r, rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>)<span class="comment">;</span></div><div class="line">        pushUP(l, r, rt)<span class="comment">;</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    void update(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt, <span class="keyword">int</span> <span class="keyword">pos</span>, <span class="keyword">int</span> d)&#123;</div><div class="line">        <span class="keyword">if</span>(l == r) &#123;</div><div class="line">            arr[<span class="keyword">pos</span>] += d<span class="comment">;</span></div><div class="line">            <span class="keyword">return</span> <span class="comment">;</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> m = (l + r) &gt;&gt; <span class="number">1</span><span class="comment">;</span></div><div class="line">        <span class="keyword">if</span>(<span class="keyword">pos</span> &lt;= m) update(l, m, rt&lt;&lt;<span class="number">1</span>, <span class="keyword">pos</span>, d)<span class="comment">;</span></div><div class="line">        <span class="keyword">else</span> update(m+<span class="number">1</span>, r, rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, <span class="keyword">pos</span>, d)<span class="comment">;</span></div><div class="line">        pushUP(l, r, rt)<span class="comment">;</span></div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;<span class="comment">;</span></div><div class="line"></div><div class="line">Segment_Tree T<span class="comment">;</span></div><div class="line"></div><div class="line"><span class="keyword">int</span> main()</div><div class="line">&#123;</div><div class="line"><span class="comment">//freopen("739c.in", "r", stdin);</span></div><div class="line"><span class="comment">//freopen(".out", "w", stdout);</span></div><div class="line"></div><div class="line">    ios_base::sync_with_stdio(false)<span class="comment">; cin.tie(0);</span></div><div class="line">    </div><div class="line">    cin &gt;&gt; n<span class="comment">;</span></div><div class="line">    rep(i, <span class="number">1</span>, n+<span class="number">1</span>) cin &gt;&gt; arr[i]<span class="comment">;</span></div><div class="line">    rep(i, <span class="number">1</span>, n) arr[i] = arr[i+<span class="number">1</span>] - arr[i]<span class="comment">;</span></div><div class="line">    --n<span class="comment">;</span></div><div class="line">    cin &gt;&gt; q<span class="comment">;</span></div><div class="line">    <span class="keyword">int</span> l, r, d<span class="comment">;</span></div><div class="line">    <span class="keyword">if</span>(!n) &#123;</div><div class="line">        rep(i, <span class="number">0</span>, q) &#123;</div><div class="line">            cin &gt;&gt; l &gt;&gt; r &gt;&gt; d<span class="comment">;</span></div><div class="line">            puts(<span class="string">"1"</span>)<span class="comment">;</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span><span class="comment">;</span></div><div class="line">    &#125;</div><div class="line">    T.build(<span class="number">1</span>, n, <span class="number">1</span>)<span class="comment">;</span></div><div class="line">    rep(i, <span class="number">0</span>, q)&#123;</div><div class="line">        cin &gt;&gt; l &gt;&gt; r &gt;&gt; d<span class="comment">;</span></div><div class="line">        <span class="keyword">if</span>(l &gt; <span class="number">1</span>) T.update(<span class="number">1</span>, n, <span class="number">1</span>, l<span class="number">-1</span>, d)<span class="comment">;</span></div><div class="line">        <span class="keyword">if</span>(r &lt;= n) T.update(<span class="number">1</span>, n, <span class="number">1</span>, r, -d)<span class="comment">;</span></div><div class="line">        printf(<span class="string">"%d\n"</span>, T.tree[<span class="number">1</span>].ans + <span class="number">1</span>)<span class="comment">;</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span><span class="comment">;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="739D、739E待解决"><a href="#739D、739E待解决" class="headerlink" title="739D、739E待解决"></a>739D、739E待解决</h2></font size>

			
            <section class="comment">
<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="/2016/12/06/codeforces-round-381/" data-title="codeforces round 381" data-url="http://zlper.net/2016/12/06/codeforces-round-381/"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"pitm"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->
</section>
        </div>
    </div>
</article>

<footer id="footer">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"> </script>
  
  <div class="outer">
    <div id="footer-info" class="inner" align = "center">
      Copyright &copy; 2016 
	  <a href="/" target="_blank"> pitmates </a> <br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
	  &nbsp;|&nbsp;
      Theme by <a href="https://github.com/XadillaX/hexadillax" target="_blank">Hexadillax</a>
	  &nbsp;|&nbsp;
      Change by <a href="https://github.com/pitmates/hexa" target="_blank">pitmates</a><br>  
	  <span id="busuanzi_container_site_pv">
        总访问量 <a href="http://service.ibruce.info/" target="_blank"><span id="busuanzi_value_site_pv"></span></a> 次
      </span>
      <span id="busuanzi_container_site_uv">
        <a href="http://service.ibruce.info/" target="_blank"><span id="busuanzi_value_site_uv"></span></a> 人
      </span>  
    </div>
  </div>
    <!-- 为超链接加上target='_blank'属性 -->
	<script type="text/javascript">
		$(document).ready(function() {
			$('a[href^="http"]').each(function() {
			$(this).attr('target', '_blank');
		});
	});
	</script>
</footer>

   

